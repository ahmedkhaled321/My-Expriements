# -*- coding: utf-8 -*-
"""Student Score Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1aXA8qFSijURTpjeMS5Z9WDWqjxmrT2ya
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from scipy.stats import gaussian_kde

"""Data Collecting"""

Student_Data=pd.read_csv('/content/sample_data/StudentPerformanceFactors.csv',encoding='windows-1252')

"""Data Reading"""

Student_Data.head(3)

"""Data Cleaning"""

Student_Data.isnull().sum()

Student_Data=Student_Data.dropna()

Student_Data.duplicated().sum()

Student_Data.head()

Student_Data.shape

Student_Data.info()

Student_Data.describe()

Q1 = Student_Data['Hours_Studied'].quantile(0.25)
Q3 = Student_Data['Hours_Studied'].quantile(0.75)
IQR = Q3 - Q1

# حدود الكشف عن القيم الشاذة
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

# تحديد القيم الشاذة
outliers = Student_Data[(Student_Data['Hours_Studied'] < lower_bound) | (Student_Data['Hours_Studied'] > upper_bound)]

c=0
for v in outliers:
  c=c+1

c

Q1 = Student_Data['Attendance'].quantile(0.25)
Q3 = Student_Data['Attendance'].quantile(0.75)
IQR = Q3 - Q1

# حدود الكشف عن القيم الشاذة
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

# تحديد القيم الشاذة
outliers1 = Student_Data[(Student_Data['Attendance'] < lower_bound) | (Student_Data['Attendance'] > upper_bound)]

c1=0
for v1 in outliers1:
  c1=c1+1

c1

Q1 = Student_Data['Sleep_Hours'].quantile(0.25)
Q3 = Student_Data['Sleep_Hours'].quantile(0.75)
IQR = Q3 - Q1

# حدود الكشف عن القيم الشاذة
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

# تحديد القيم الشاذة
outliers2 = Student_Data[(Student_Data['Sleep_Hours'] < lower_bound) | (Student_Data['Sleep_Hours'] > upper_bound)]

c2=0
for v2 in outliers2:
  c2=c2+1

c2

Q1 = Student_Data['Previous_Scores'].quantile(0.25)
Q3 = Student_Data['Previous_Scores'].quantile(0.75)
IQR = Q3 - Q1

# حدود الكشف عن القيم الشاذة
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

# تحديد القيم الشاذة
outliers3 = Student_Data[(Student_Data['Previous_Scores'] < lower_bound) | (Student_Data['Previous_Scores'] > upper_bound)]

c3=0
for v3 in outliers3:
  c3=c3+1

c3

Q1 = Student_Data['Tutoring_Sessions'].quantile(0.25)
Q3 = Student_Data['Tutoring_Sessions'].quantile(0.75)
IQR = Q3 - Q1

# حدود الكشف عن القيم الشاذة
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

# تحديد القيم الشاذة
outliers4 = Student_Data[(Student_Data['Tutoring_Sessions'] < lower_bound) | (Student_Data['Tutoring_Sessions'] > upper_bound)]

c4=0
for v4 in outliers4:
  c4=c4+1

c4

Q1 = Student_Data['Physical_Activity'].quantile(0.25)
Q3 = Student_Data['Physical_Activity'].quantile(0.75)
IQR = Q3 - Q1

# حدود الكشف عن القيم الشاذة
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

# تحديد القيم الشاذة
outliers5 = Student_Data[(Student_Data['Physical_Activity'] < lower_bound) | (Student_Data['Physical_Activity'] > upper_bound)]

c5=0
for v5 in outliers5:
  c5=c5+1

c5

Student_Data.head()

Student_Data['Parental_Involvement'].value_counts()

Student_Data['Access_to_Resources'].value_counts()

Student_Data['Extracurricular_Activities'].value_counts()

Student_Data['Motivation_Level'].value_counts()

Student_Data['Internet_Access'].value_counts()

Student_Data['Family_Income'].value_counts()

Student_Data['Teacher_Quality'].value_counts()

Student_Data['School_Type'].value_counts()

Student_Data['Peer_Influence'].value_counts()

Student_Data['Learning_Disabilities'].value_counts()

Student_Data['Parental_Education_Level'].value_counts()

Student_Data['Distance_from_Home'].value_counts()

Student_Data['Gender'].value_counts()

Student_Data['Hours_Studied'].value_counts()

Student_Data['Attendance'].value_counts()

Student_Data['Sleep_Hours'].value_counts()

Student_Data['Previous_Scores'].value_counts()

Student_Data['Tutoring_Sessions'].value_counts()

Student_Data['Physical_Activity'].value_counts()

Data=Student_Data.describe(include='all')

Data

"""Data Visualzation

Histogram Plot
"""

Student_Data.columns

num_cols = Student_Data.select_dtypes(include=[np.number])

num_cols.columns

cat_cols = Student_Data.select_dtypes(include=["object", "category"])

cat_cols.columns

plt.figure(figsize=(10,5))
plt.hist(Student_Data['Hours_Studied'])
plt.ylabel('Count Of Value')
plt.show()

plt.figure(figsize=(10,5))
plt.hist(Student_Data['Attendance'])
plt.ylabel('Count Of Value')
plt.show()

plt.figure(figsize=(10,5))
plt.hist(Student_Data['Sleep_Hours'])
plt.ylabel('Count Of Value')
plt.show()

plt.figure(figsize=(10,5))
plt.hist(Student_Data['Previous_Scores'])
plt.ylabel('Count Of Value')
plt.show()

plt.figure(figsize=(10,5))
plt.hist(Student_Data['Tutoring_Sessions'])
plt.ylabel('Count Of Value')
plt.show()

plt.figure(figsize=(10,5))
plt.hist(Student_Data['Physical_Activity'])
plt.ylabel('Count Of Value')
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.countplot(x='Parental_Involvement',data=Student_Data,palette=array1)

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.countplot(x='Access_to_Resources',data=Student_Data,palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue']
sns.countplot(x='Extracurricular_Activities',data=Student_Data,palette=array1)

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.countplot(x='Motivation_Level',data=Student_Data,palette=array1)

plt.figure(figsize=(10,5))
array1=['red','blue']
sns.countplot(x='Internet_Access',data=Student_Data,palette=array1)

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.countplot(x='Family_Income',data=Student_Data,palette=array1)

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.countplot(x='Teacher_Quality',data=Student_Data,palette=array1)

plt.figure(figsize=(10,5))
array1=['red','blue']
sns.countplot(x='School_Type',data=Student_Data,palette=array1)

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.countplot(x='Peer_Influence',data=Student_Data,palette=array1)

plt.figure(figsize=(10,5))
array1=['red','blue']
sns.countplot(x='Learning_Disabilities',data=Student_Data,palette=array1)

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.countplot(x='Parental_Education_Level',data=Student_Data,palette=array1)

array1=['red','blue','green']
counts=Student_Data['Parental_Involvement'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue','green']
counts=Student_Data['Access_to_Resources'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue']
counts=Student_Data['Extracurricular_Activities'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue','green']
counts=Student_Data['Motivation_Level'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue']
counts=Student_Data['Internet_Access'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue','green']
counts=Student_Data['Family_Income'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue','green']
counts=Student_Data['Teacher_Quality'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue']
counts=Student_Data['School_Type'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue','green']
counts=Student_Data['Peer_Influence'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue']
counts=Student_Data['Learning_Disabilities'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

array1=['red','blue','green']
counts=Student_Data['Parental_Education_Level'].value_counts()
plt.pie(counts,labels=counts.index,colors=array1,autopct='%1.1f%%',
        shadow=True, startangle=140)
plt.show()

num_cols.columns

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Hours_Studied'],y=Student_Data['Attendance'])
plt.xlabel('Hours_Studied')
plt.ylabel('Attendance')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Hours_Studied'],y=Student_Data['Sleep_Hours'])
plt.xlabel('Hours_Studied')
plt.ylabel('Sleep_Hours')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Hours_Studied'],y=Student_Data['Previous_Scores'])
plt.xlabel('Hours_Studied')
plt.ylabel('Previous_Scores')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Hours_Studied'],y=Student_Data['Tutoring_Sessions'])
plt.xlabel('Hours_Studied')
plt.ylabel('Tutoring_Sessions')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Hours_Studied'],y=Student_Data['Physical_Activity'])
plt.xlabel('Hours_Studied')
plt.ylabel('Physical_Activity')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Hours_Studied'],y=Student_Data['Exam_Score'])
plt.xlabel('Hours_Studied')
plt.ylabel('Exam_Score')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Attendance'],y=Student_Data['Sleep_Hours'])
plt.xlabel('Attendance')
plt.ylabel('Sleep_Hours')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Attendance'],y=Student_Data['Previous_Scores'])
plt.xlabel('Attendance')
plt.ylabel('Previous_Scores')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Attendance'],y=Student_Data['Tutoring_Sessions'])
plt.xlabel('Attendance')
plt.ylabel('Tutoring_Sessions')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Attendance'],y=Student_Data['Physical_Activity'])
plt.xlabel('Attendance')
plt.ylabel('Physical_Activity')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Attendance'],y=Student_Data['Exam_Score'])
plt.xlabel('Attendance')
plt.ylabel('Exam_Score')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Sleep_Hours'],y=Student_Data['Previous_Scores'])
plt.xlabel('Sleep_Hours')
plt.ylabel('Previous_Scores')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Sleep_Hours'],y=Student_Data['Tutoring_Sessions'])
plt.xlabel('Sleep_Hours')
plt.ylabel('Tutoring_Sessions')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Sleep_Hours'],y=Student_Data['Physical_Activity'])
plt.xlabel('Sleep_Hours')
plt.ylabel('Physical_Activity')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Sleep_Hours'],y=Student_Data['Exam_Score'])
plt.xlabel('Sleep_Hours')
plt.ylabel('Exam_Score')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Previous_Scores'],y=Student_Data['Tutoring_Sessions'])
plt.xlabel('Previous_Scores')
plt.ylabel('Tutoring_Sessions')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Previous_Scores'],y=Student_Data['Physical_Activity'])
plt.xlabel('Previous_Scores')
plt.ylabel('Physical_Activity')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Previous_Scores'],y=Student_Data['Tutoring_Sessions'])
plt.xlabel('Previous_Scores')
plt.ylabel('Tutoring_Sessions')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Previous_Scores'],y=Student_Data['Physical_Activity'])
plt.xlabel('Previous_Scores')
plt.ylabel('Physical_Activity')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Previous_Scores'],y=Student_Data['Exam_Score'])
plt.xlabel('Previous_Scores')
plt.ylabel('Exam_Score')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Tutoring_Sessions'],y=Student_Data['Physical_Activity'])
plt.xlabel('Tutoring_Sessions')
plt.ylabel('Physical_Activity')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Tutoring_Sessions'],y=Student_Data['Exam_Score'])
plt.xlabel('Tutoring_Sessions')
plt.ylabel('Exam_Score')
plt.show()

plt.figure(figsize=(10,5))
plt.scatter(x=Student_Data['Physical_Activity'],y=Student_Data['Exam_Score'])
plt.xlabel('Physical_Activity')
plt.ylabel('Exam_Score')
plt.show()

num_cols.columns

cat_cols.columns

array1=['red','blue','green']
sns.stripplot(x='Parental_Involvement', y='Hours_Studied', data=Student_Data,palette=array1)
plt.title('Stripplot of Hours_Studied by Parental_Involvement')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Parental_Involvement', y='Attendance', data=Student_Data,palette=array1)
plt.title('Stripplot of Attendance by Parental_Involvement')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Parental_Involvement', y='Sleep_Hours', data=Student_Data,palette=array1)
plt.title('Stripplot of Sleep_Hours by Parental_Involvement')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Parental_Involvement', y='Previous_Scores', data=Student_Data,palette=array1)
plt.title('Stripplot of Previous_Scores by Parental_Involvement')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Parental_Involvement', y='Tutoring_Sessions', data=Student_Data,palette=array1)
plt.title('Stripplot of Tutoring_Sessions by Parental_Involvement')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Parental_Involvement', y='Physical_Activity', data=Student_Data,palette=array1)
plt.title('Stripplot of Physical_Activity by Parental_Involvement')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Parental_Involvement', y='Exam_Score', data=Student_Data,palette=array1)
plt.title('Stripplot of Exam_Score by Parental_Involvement')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Access_to_Resources', y='Hours_Studied', data=Student_Data,palette=array1)
plt.title('Stripplot of Hours_Studied by Access_to_Resources')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Access_to_Resources', y='Attendance', data=Student_Data,palette=array1)
plt.title('Stripplot of Attendance by Access_to_Resources')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Access_to_Resources', y='Sleep_Hours', data=Student_Data,palette=array1)
plt.title('Stripplot of Sleep_Hours by Access_to_Resources')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Access_to_Resources', y='Previous_Scores', data=Student_Data,palette=array1)
plt.title('Stripplot of Previous_Scores by Access_to_Resources')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Access_to_Resources', y='Tutoring_Sessions', data=Student_Data,palette=array1)
plt.title('Stripplot of Tutoring_Sessions by Access_to_Resources')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Access_to_Resources', y='Exam_Score', data=Student_Data,palette=array1)
plt.title('Stripplot of Exam_Score by Access_to_Resources')
plt.show()

num_cols.columns

array1=['red','blue']
sns.stripplot(x='Extracurricular_Activities', y='Hours_Studied', data=Student_Data,palette=array1)
plt.title('Stripplot of Hours_Studied by Extracurricular_Activities')
plt.show()

array1=['red','blue']
sns.stripplot(x='Extracurricular_Activities', y='Attendance', data=Student_Data,palette=array1)
plt.title('Stripplot of Attendance by Extracurricular_Activities')
plt.show()

array1=['red','blue']
sns.stripplot(x='Extracurricular_Activities', y='Sleep_Hours', data=Student_Data,palette=array1)
plt.title('Stripplot of Sleep_Hours by Extracurricular_Activities')
plt.show()

array1=['red','blue']
sns.stripplot(x='Extracurricular_Activities', y='Previous_Scores', data=Student_Data,palette=array1)
plt.title('Stripplot of Sleep_Hours by Extracurricular_Activities')
plt.show()

array1=['red','blue']
sns.stripplot(x='Extracurricular_Activities', y='Tutoring_Sessions', data=Student_Data,palette=array1)
plt.title('Stripplot of Tutoring_Sessions by Extracurricular_Activities')
plt.show()

array1=['red','blue']
sns.stripplot(x='Extracurricular_Activities', y='Physical_Activity', data=Student_Data,palette=array1)
plt.title('Stripplot of Physical_Activity by Extracurricular_Activities')
plt.show()

array1=['red','blue']
sns.stripplot(x='Extracurricular_Activities', y='Exam_Score', data=Student_Data,palette=array1)
plt.title('Stripplot of Exam_Score by Extracurricular_Activities')
plt.show()

num_cols.columns

num_cols

cat_cols.columns

cat_cols

array1=['red','blue','green']
sns.stripplot(x='Motivation_Level', y='Hours_Studied', data=Student_Data,palette=array1)
plt.title('Stripplot of Hours_Studied by Motivation_Level')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Motivation_Level', y='Attendance', data=Student_Data,palette=array1)
plt.title('Stripplot of Attendance by Motivation_Level')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Motivation_Level', y='Sleep_Hours', data=Student_Data,palette=array1)
plt.title('Stripplot of Sleep_Hours by Motivation_Level')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Motivation_Level', y='Previous_Scores', data=Student_Data,palette=array1)
plt.title('Stripplot of Previous_Scores by Motivation_Level')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Motivation_Level', y='Tutoring_Sessions', data=Student_Data,palette=array1)
plt.title('Stripplot of Tutoring_Sessions by Motivation_Level')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Motivation_Level', y='Physical_Activity', data=Student_Data,palette=array1)
plt.title('Stripplot of Physical_Activity by Motivation_Level')
plt.show()

array1=['red','blue','green']
sns.stripplot(x='Motivation_Level', y='Exam_Score', data=Student_Data,palette=array1)
plt.title('Stripplot of Exam_Score by Motivation_Level')
plt.show()

num_cols.columns

cat_cols.columns

array1=['red','blue']
sns.stripplot(x='Internet_Access', y='Hours_Studied',data=Student_Data,palette=array1)
plt.title('Stripplot of Hours_Studied by Internet_Access')
plt.show()

array1=['red','blue']
sns.stripplot(x='Internet_Access', y='Attendance',data=Student_Data,palette=array1)
plt.title('Stripplot of Attendance by Internet_Access')
plt.show()

array1=['red','blue']
sns.stripplot(x='Internet_Access', y='Sleep_Hours',data=Student_Data,palette=array1)
plt.title('Stripplot of Sleep_Hours by Internet_Access')
plt.show()

array1=['red','blue']
sns.stripplot(x='Internet_Access', y='Previous_Scores',data=Student_Data,palette=array1)
plt.title('Stripplot of Previous_Scores by Internet_Access')
plt.show()

array1=['red','blue']
sns.stripplot(x='Internet_Access', y='Tutoring_Sessions',data=Student_Data,palette=array1)
plt.title('Stripplot of Tutoring_Sessions by Internet_Access')
plt.show()

array1=['red','blue']
sns.stripplot(x='Internet_Access', y='Physical_Activity',data=Student_Data,palette=array1)
plt.title('Stripplot of Physical_Activity by Internet_Access')
plt.show()

array1=['red','blue']
sns.stripplot(x='Internet_Access', y='Exam_Score',data=Student_Data,palette=array1)
plt.title('Stripplot of Exam_Score by Internet_Access')
plt.show()

num_cols.columns

cat_cols.columns

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Family_Income',y='Hours_Studied',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Family_Income',y='Attendance',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Family_Income',y='Sleep_Hours',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Family_Income',y='Previous_Scores',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Family_Income',y='Tutoring_Sessions',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Family_Income',y='Physical_Activity',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Family_Income',y='Exam_Score',palette=array1)
plt.show()

num_cols.columns

cat_cols.columns

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Teacher_Quality',y='Hours_Studied',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Teacher_Quality',y='Attendance',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Teacher_Quality',y='Sleep_Hours',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Teacher_Quality',y='Previous_Scores',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Teacher_Quality',y='Tutoring_Sessions',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Teacher_Quality',y='Physical_Activity',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','green','blue']
sns.stripplot(data=Student_Data,x='Teacher_Quality',y='Exam_Score',palette=array1)
plt.show()

num_cols.columns

cat_cols.columns

plt.figure(figsize=(10,5))
array1=['red','green']
sns.stripplot(data=Student_Data,x='School_Type',y='Exam_Score',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.stripplot(data=Student_Data,x='Peer_Influence',y='Exam_Score',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue']
sns.stripplot(data=Student_Data,x='Learning_Disabilities',y='Exam_Score',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.stripplot(data=Student_Data,x='Parental_Education_Level',y='Exam_Score',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.stripplot(data=Student_Data,x='Distance_from_Home',y='Exam_Score',palette=array1)
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue']
sns.stripplot(data=Student_Data,x='Gender',y='Exam_Score',palette=array1)
plt.show()

num_cols.columns

cat_cols.columns

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.stripplot(data=Student_Data,x='Parental_Involvement',y='Exam_Score',palette=array1,hue='Access_to_Resources')
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue']
sns.stripplot(data=Student_Data,x='Parental_Involvement',y='Exam_Score',palette=array1,hue='Internet_Access')
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.stripplot(data=Student_Data,x='Parental_Involvement',y='Exam_Score',palette=array1,hue='Family_Income')
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue','green']
sns.stripplot(data=Student_Data,x='Parental_Involvement',y='Exam_Score',palette=array1,hue='Teacher_Quality')
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue']
sns.stripplot(data=Student_Data,x='Parental_Involvement',y='Exam_Score',palette=array1,hue='School_Type')
plt.show()

plt.figure(figsize=(10,5))
array1=['red','blue']
sns.stripplot(data=Student_Data,x='Parental_Involvement',y='Exam_Score',palette=array1,hue='Gender')
plt.show()

"""Encoding Of Categorical Features"""

Student_Data.head(3)

from sklearn.preprocessing import OneHotEncoder,LabelEncoder

Lr=LabelEncoder()

Ohe=OneHotEncoder(sparse_output=False)

Student_Data['Extracurricular_Activities']=Lr.fit_transform(Student_Data['Extracurricular_Activities'])

Student_Data['Internet_Access']=Ohe.fit_transform(Student_Data[['Internet_Access']])

Student_Data['School_Type']=Lr.fit_transform(Student_Data['School_Type'])

Student_Data['Peer_Influence']=Ohe.fit_transform(Student_Data[['Peer_Influence']])

Student_Data['Learning_Disabilities']=Ohe.fit_transform(Student_Data[['Learning_Disabilities']])

Student_Data['Gender']=Lr.fit_transform(Student_Data['Gender'])

Student_Data['Parental_Involvement']=Ohe.fit_transform(Student_Data[['Parental_Involvement']])

Student_Data['Access_to_Resources']=Ohe.fit_transform(Student_Data[['Access_to_Resources']])

Student_Data['Motivation_Level']=Ohe.fit_transform(Student_Data[['Motivation_Level']])

Student_Data['Family_Income']=Ohe.fit_transform(Student_Data[['Family_Income']])

Student_Data['Teacher_Quality']=Ohe.fit_transform(Student_Data[['Teacher_Quality']])

Student_Data['Parental_Education_Level']=Ohe.fit_transform(Student_Data[['Parental_Education_Level']])

Student_Data['Distance_from_Home']=Ohe.fit_transform(Student_Data[['Distance_from_Home']])

Student_Data

Student_Data.info()

Student_Data['Parental_Involvement']=Student_Data['Parental_Involvement'].astype('int')

Student_Data['Access_to_Resources']=Student_Data['Access_to_Resources'].astype('int')

Student_Data['Motivation_Level']=Student_Data['Motivation_Level'].astype('int')

Student_Data['Internet_Access']=Student_Data['Internet_Access'].astype('int')

Student_Data['Family_Income']=Student_Data['Family_Income'].astype('int')

Student_Data['Teacher_Quality']=Student_Data['Teacher_Quality'].astype('int')

Student_Data['Learning_Disabilities']=Student_Data['Learning_Disabilities'].astype('int')

Student_Data[' Parental_Education_Level']=Student_Data['Parental_Education_Level'].astype('int')

Student_Data['Distance_from_Home']=Student_Data['Distance_from_Home'].astype('int')

Student_Data

"""Feature Selection"""

Correlation=Student_Data.corr()

plt.figure(figsize=(30,15))
sns.heatmap(Correlation,annot=True,cmap='coolwarm')
plt.show()

from sklearn.feature_selection import mutual_info_regression

Input=Student_Data.drop('Exam_Score',axis=1)

Output=Student_Data['Exam_Score']

Array=mutual_info_regression(Input,Output,random_state=1)

Array

colors = []
for _ in range(21):
    # توليد لون RGB عشوائي
    color = "#{:06x}".format(np.random.randint(0, 0xFFFFFF))
    colors.append(color)

plt.figure(figsize=(10,5))
plt.bar(Input.columns,Array,color=colors)
plt.xticks(rotation=90)
plt.xlabel('Features')
plt.ylabel('Importance')
plt.show()

from sklearn.feature_selection import f_regression

# Compute p-values
_, p_values = f_regression(Input, Output)

# Show results
p_values_df = pd.DataFrame({
    'Feature': Input.columns,
    'P_Value': p_values
}).sort_values(by='P_Value')

print(p_values_df)

plt.figure(figsize=(10,5))
plt.bar(Input.columns,p_values,color=colors)
plt.xticks(rotation=90)
plt.xlabel('Features')
plt.ylabel('P_Value_Importance')
plt.show()

"""Splitting DataFrame into Input , Output"""

X=Student_Data[['Attendance','Hours_Studied']]

Y=Student_Data['Exam_Score']

X

Y

"""Applying Machine Learning Model"""

from sklearn.model_selection import train_test_split

X_Train,X_Test,Y_Train,Y_Test=train_test_split(X,Y,test_size=0.2,random_state=42)

X_Train

X_Test

Y_Train

from sklearn.linear_model import Lasso,Ridge

L=Lasso(alpha=0.01)

L.fit(X_Train,Y_Train)

y_pred_lasso = L.predict(X_Test)

R=Ridge(alpha=0.01)

R.fit(X_Train,Y_Train)

# Create a DataFrame to compare coefficients
feature_names = [f"Feature_{i+1}" for i in range(X.shape[1])]
coef_df = pd.DataFrame({
    "Feature": feature_names,
    "Ridge_Coefficient": R.coef_,
    "Lasso_Coefficient": L.coef_
})

coef_df

Y_Test

from sklearn.linear_model import LinearRegression

Lr=LinearRegression()

Lr.fit(X_Train,Y_Train)

Y_Pred_Train=Lr.predict(X_Train)

Y_Pred_Test=Lr.predict(X_Test)

"""Evaluation"""

from sklearn.metrics import r2_score,mean_absolute_error,mean_squared_error

r2=r2_score(Y_Test,Y_Pred_Test)

r2

M_A_E=mean_absolute_error(Y_Test,Y_Pred_Test)

M_A_E

M_S_E=mean_squared_error(Y_Test,Y_Pred_Test)

M_S_E

# رسم المخطط
plt.figure(figsize=(6,6))
plt.scatter(Y_Test  , Y_Pred_Test, label='Predictied Values Vs Actual Values')
plt.plot(Y_Test, Y_Test, color='green', linestyle='--', label='Best Line(y=x)')
plt.plot(Y_Test, Y_Pred_Test, color='red', label='Actual Regession Line')
plt.xlabel('Actual Values')
plt.ylabel('Predictied Values')
plt.title(f'Comparsion Of Model R2=({r2:.2f})')
plt.legend()
plt.grid(True)
plt.show()

"""RandomForestRegression Model"""

from sklearn.ensemble import RandomForestRegressor

Rf=RandomForestRegressor(n_estimators=10,min_samples_split=2,random_state=3)

Importance_Of_Feature=Rf.feature_importances_

ArrayOfColors=['red','blue']

plt.figure(figsize=(10,5))
plt.bar(X.columns,Importance_Of_Feature,color=ArrayOfColors)
plt.xticks(rotation=90)
plt.xlabel('Features')
plt.ylabel('Importance')
plt.show()

Rf.fit(X_Train,Y_Train)

Y_Pred_Train1=Rf.predict(X_Train)

Y_Pred_Test1=Rf.predict(X_Test)

"""Evaluation Of RandomForest Model"""

r2_Rf=r2_score(Y_Test,Y_Pred_Test1)

r2_Rf

M_A_E1=mean_absolute_error(Y_Test,Y_Pred_Test1)

M_A_E1

M_S_E1=mean_squared_error(Y_Test,Y_Pred_Test1)

M_S_E1

"""Deployment(Simple)"""

import joblib

Model=joblib.dump(Lr,'Linear_Regression.pkl')

!pip install streamlit pyngrok

# Commented out IPython magic to ensure Python compatibility.
# %%writefile StudentScore.py
# import joblib
# import streamlit as st
# import pandas as pd
# 
# 
# Lr_Model=joblib.load('Linear_Regression.pkl')
# 
# 
# st.title('Prediction Of Student Score Using Linear Regression Model')
# 
# 
# 
# 
# PrecentageOfAttendance=st.number_input('Enter Your Percent Of Attendance',min_value=0,max_value=100)
# Hours_Studied=st.number_input('Enter Hours_Studied')
# 
# 
# 
# 
# Button=st.button('Predict')
# 
# 
# if Button:
# 
# 
#     Prediction=Lr_Model.predict(pd.DataFrame({'Attendance':[PrecentageOfAttendance],'Hours_Studied':[Hours_Studied]}))
#     st.success(f'Predictied Student Score is {Prediction[0]}')
# 
# 
# 
# 
#

"""Running Ui On Desktop"""

from pyngrok import ngrok

!streamlit run StudentScore.py --server.port 8501 --server.headless true &>/dev/null&

!ngrok config add-authtoken 32MXqWXJ71X2BSMjYvtnWNqNfvm_7mVrdRrBDE6dKg4BmWi6A

ngrok.kill()

public_url = ngrok.connect(8501)
print("Link Of App", public_url)